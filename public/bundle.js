"use strict";(()=>{var I=class{constructor(e){this.parent=null;this.html=document.createElement(e)}setParent(e){e?e.appendChild(this.html):this.parent?.removeChild(this.html),this.parent=e}};var B=class extends I{constructor(){super("canvas");this.cachedWidth=0;this.cachedHeight=0;this.windowScale=1;this.ctx=this.html.getContext("2d"),this.html.addEventListener("contextmenu",t=>t.preventDefault())}resize(t,i,o){t*=o,i*=o,this.html.width=this.cachedWidth=t,this.html.height=this.cachedHeight=i,this.windowScale=Math.max(t/1920,i/1080)}setCursorStyle(t){this.html.style.cursor=t}};var z=class{constructor(e,t){this.app=e;this.components={};this.zOrder=3;this.destroyed=!1;let i=Object.keys(t);for(let o=0,n=i.length;o<n;++o){let s=t[i[o]];s.init(this),this.components[i[o]]=s}}getComponent(e){return this.components[e]}cleanup(){for(let e in this.components)delete this.components[e]}destroy(){this.destroyed=!0}};var O=class extends I{constructor(){super("style"),this.addStyle("body",{margin:0,overflow:"hidden"}),this.addStyle("canvas",{width:"100vw",height:"100vh"}),this.addStyle("@font-face",{fontFamily:"Ubuntu",src:"url(./Ubuntu.ttf)"})}addStyle(e,t){this.html.innerHTML+=e+"{"+Object.keys(t).map(i=>i+":"+t[i].toString()).join(";")+"}"}};var N=class{constructor(){this.canvas=new B;this.styles=new O;this.canvas.setParent(document.body),this.styles.setParent(document.head)}};var Y=class Y{constructor(){this.window=new N;this.entities=new Set;this.dt=1e-4;this.backgroundColor="#777";this.shakePower=0;this.cachedGameLoop=this.gameLoop.bind(this);this.cachedCanvasResize=()=>this.window.canvas.resize(window.innerWidth,window.innerHeight,window.devicePixelRatio);this.lastTime=0;this.entitiesSorted=!1}gameLoop(){let e=Y.now();this.lastTime&&(this.dt=Math.min(1e3/30,e-this.lastTime)/1e3),this.lastTime=e,this.entitiesSorted||(this.entities=new Set(Array.from(this.entities).sort((n,s)=>n.zOrder-s.zOrder)),this.entitiesSorted=!1);let t=this.window.canvas.ctx,i=this.window.canvas,o={x:i.cachedWidth/2,y:i.cachedHeight/2,width:i.cachedWidth,height:i.cachedHeight,winScale:this.window.canvas.windowScale,dt:this.dt};this.shakePower&&(o.x+=Math.random()*this.shakePower-this.shakePower/2,o.y+=Math.random()*this.shakePower-this.shakePower/2),t.fillStyle=this.backgroundColor,t.fillRect(0,0,i.cachedWidth,i.cachedHeight),this.setCursorStyle("default");for(let n of Array.from(this.entities)){if(n.destroyed)continue;let s=n.getComponent("base"),a=n.getComponent("ui");s&&"update"in s&&s.update(this.dt),a&&a.render(t,o)}for(let n of this.entities)n.destroyed&&(n.cleanup(),this.entities.delete(n));requestAnimationFrame(this.cachedGameLoop)}run(){window.addEventListener("resize",this.cachedCanvasResize),window.addEventListener("focus",()=>this.lastTime=Y.now()),this.cachedCanvasResize(),this.gameLoop()}spawn(e){let t=new z(this,e);return this.entities.add(t),this.entitiesSorted=!1,t}setCursorStyle(e){this.window.canvas.setCursorStyle(e)}};Y.now="performance"in window&&"now"in performance?performance.now.bind(performance):Date.now;var x=Y;var G=class G{constructor(e,t){this.text=e;this.mouseOver=!1;this.isPressed=!1;this.hidden=!1;this.clicked=!1;this.options=Object.assign({offsetX:0,offsetY:0,screenX:0,screenY:0,width:150,height:50,fontSize:22,fontColor:"#fff",strokeWidth:0,strokeColor:"#fff",overStrokeColor:"#fff",pressStrokeColor:"#fff",rounding:0,fillStyle:"rgba(0,0,0,0.5)"},t)}render(e,t){if(this.hidden)return;let i=this.options,o=this.measure(t);if(this.update(t.width,t.height,t.winScale,o.width/2),e.beginPath(),e.roundRect(o.x,o.y,o.w,o.h,o.r),e.closePath(),o.width&&(e.strokeStyle=this.isPressed?i.pressStrokeColor:this.mouseOver?i.overStrokeColor:i.strokeColor,e.lineWidth=o.width,e.stroke()),e.fillStyle=i.fillStyle,e.fill(),!this.options.fontSize)return;let n=G.getTextImageCached(this.text,i.fontSize*t.winScale,i.fontColor);e.drawImage(n[1],o.x+o.w/2-n[0].width/2,o.y+o.h/2-i.fontSize*t.winScale/2)}update(e,t,i,o){this.mouseOver=this.isMouseOver(e,t,i,o),this.isPressed=this.mouseOver&&r.mouse.click,this.mouseOver?(r.instance.app.setCursorStyle("pointer"),this.isPressed?this.clicked=!0:this.clicked&&(this.onClick(),this.clicked=!1)):this.clicked=!1}isMouseOver(e,t,i,o){let n=r.mouse,s=this.options,a=(s.width/2+o)*i,p=(s.height/2+o)*i,u=s.offsetX*i+s.screenX*e,b=s.offsetY*i+s.screenY*t;return n.x>u-a&&n.x<u+a&&n.y>b-p&&n.y<b+p}measure(e){let t=this.options,i=t.width*e.winScale,o=t.height*e.winScale;return{w:i,h:o,x:t.offsetX*e.winScale+t.screenX*e.width-i/2,y:t.offsetY*e.winScale+t.screenY*e.height-o/2,r:t.rounding*e.winScale,width:t.strokeWidth*e.winScale*2}}static getTextImageCached(e,t,i){let o=G.textCache.get(e+t+i);if(o)return o;let n=document.createElement("canvas");n.width=n.height=1;let s=n.getContext("2d");s.font=`${t}px Ubuntu`;let a=s.measureText(e);n.width=a.width,n.height=t,s.font=`${t}px Ubuntu`,s.textAlign="center",s.textBaseline="middle",s.fillStyle=i,s.fillText(e,n.width/2,n.height/2);let p=[a,n];return G.textCache.set(e+t+i,p),p}};G.textCache=new Map;var h=G;var X=class extends h{constructor(t){super("START",{width:120,height:40,fontSize:28,fontColor:"#fff",strokeWidth:4,strokeColor:"rgb(255, 55, 55)",overStrokeColor:"rgb(221, 61, 61)",pressStrokeColor:"rgb(255, 106, 106)",rounding:20});this.challenge=t;this.level=0}render(t,i){let o=this.measure(i),n=i.width/2,s=20*i.winScale,a=60*i.winScale;this.options.offsetX=n/2/i.winScale,t.beginPath(),t.roundRect(o.x-20*i.winScale,o.y-20*i.winScale,o.w+n+20*i.winScale,o.h+a,16),t.closePath(),t.fillStyle="rgba(42, 5, 5, 0.5)",t.fill(),t.textBaseline="middle",t.font=36*i.winScale+"px Ubuntu",t.textAlign="left",t.fillStyle="#fff",t.fillText(this.challenge.name+" Challenge ",o.x+140*i.winScale,o.y+s),t.font=24*i.winScale+"px Ubuntu",t.textAlign="right",t.fillText(this.challenge.completed?"Completed in "+this.challenge.completedTime.toFixed(0)+"s":"Uncompleted",o.x+n+80*i.winScale,o.y+s*1.5),t.font=18*i.winScale+"px Ubuntu",t.textAlign="left",t.fillStyle="#ddd",t.fillText(this.challenge.description+". Reward: "+this.challenge.reward,o.x,o.y+s+40*i.winScale),super.render(t,i)}onClick(){this.challenge.start()}};var V=class extends h{constructor(){super("CHALLENGES",{offsetX:-170,offsetY:40,screenX:1,width:300,height:40,fontSize:26,fontColor:"#fff",strokeWidth:4,strokeColor:"hsl(0, 64%, 71%)",overStrokeColor:"hsl(0, 100%, 86%)",pressStrokeColor:"hsl(0, 41.00%, 69.40%)",rounding:20})}onClick(){r.instance.overlay.scene=3}};var F=class extends h{constructor(){super("END CHALLENGE",{offsetX:-170,offsetY:80,screenX:1,width:300,height:40,fontSize:26,fontColor:"#fff",strokeWidth:4,strokeColor:"rgb(255, 55, 55)",overStrokeColor:"rgb(221, 61, 61)",pressStrokeColor:"rgb(255, 106, 106)",rounding:12})}onClick(){let e=r.instance;e.epoch.currentChallenge?.end(!1),e.overlay.scene=1}};var d=class extends h{constructor(t,i,o){super(i,{width:120,height:40,fontSize:28,fontColor:"#fff",strokeWidth:4,strokeColor:"rgb(218, 255, 55)",overStrokeColor:"rgb(191, 221, 61)",pressStrokeColor:"rgb(228, 255, 106)",rounding:20});this.name=t;this.cost=o;this.level=0}render(t,i){let o=this.measure(i),n=i.width/2,s=20*i.winScale,a=60*i.winScale;this.options.offsetX=n/2/i.winScale,t.beginPath(),t.roundRect(o.x-20*i.winScale,o.y-20*i.winScale,o.w+n+20*i.winScale,o.h+a,16),t.closePath(),t.fillStyle="rgba(0,0,0,0.5)",t.fill(),t.textBaseline="middle",t.font=36*i.winScale+"px Ubuntu",t.textAlign="left",t.fillStyle="#fff",t.fillText(this.name+" Upgrade ["+this.level+"]",o.x+140*i.winScale,o.y+s),t.font=24*i.winScale+"px Ubuntu",t.textAlign="right",t.fillText("Cost "+r.format(this.cost)+" EP",o.x+n+80*i.winScale,o.y+s*1.5),t.font=18*i.winScale+"px Ubuntu",t.textAlign="left",t.fillStyle="#ddd",t.fillText(this.getDescription(),o.x,o.y+s+40*i.winScale),super.render(t,i)}onClick(){let t=r.instance;t.epoch.points<this.cost||(t.epoch.points-=this.cost,this.onPurchase(t),this.level+=1)}purchaseMany(t,i){for(let o=0;o<i;++o)this.onPurchase(t)}onSave(t){t.writeU8(this.level)}onLoad(t){this.level=t.readU8()}};var W=class extends d{constructor(){super("Cost","x0.95",1)}onPurchase(e){e.epoch.multipliers.cost*=.95,this.cost*=2}getDescription(){return"Decrease all rocket's cost by 5% each upgrade. Current cost multiplier is "+r.instance.epoch.multipliers.cost.toFixed(3)}};var Z=class extends d{constructor(){super("Penetration","+1%",1)}onPurchase(e){e.epoch.penetrationChance+=.01,this.cost*=2}getDescription(){return"Increase the change of rocket to penetrate the planet by 1%. Current penetration chance is "+(r.instance.epoch.penetrationChance*100).toFixed(0)+"%"}};var C=class l{constructor(){this.data=null}update(e){this.data=e}intersects(e,t){return!this.data||!e.data?!1:l.circleIntersectCircle(this.data,e.data,t)}static circleIntersectCircle(e,t,i){let o=e.x-t.x,n=e.y-t.y,s=e.radius+(i?0:t.radius);return o*o+n*n<=s*s}};var j=class{constructor(e,t,i,o,n){this.x=e;this.y=t;this.size=i;this.angle=o;this.type=n;this.entity=null}init(e){e.zOrder=0,this.entity=e,r.instance.decorations.push(this)}};var q=class{constructor(){this.decoration=null}init(e){this.decoration=e.getComponent("base")}render(e,t){let i=r.instance.planet,o=t.winScale/i.scale,n=this.decoration.size*o;switch(e.translate(t.x+this.decoration.x*t.winScale,t.y+this.decoration.y*t.winScale),this.decoration.type==1&&e.rotate(this.decoration.angle),e.fillStyle=i.layers[0].color||"#ddd",this.decoration.type){case 0:e.beginPath(),e.arc(0,0,this.decoration.size*o,0,2*Math.PI),e.closePath(),e.fill();break;case 1:e.beginPath(),e.lineTo(n*2,0),e.lineTo(-n*.1,n*.75),e.lineTo(-n*.1,-n*.75),e.closePath(),e.fill();break}e.resetTransform()}};var $=class{constructor(){this.app=null;this.hit=null}init(e){this.app=e.app,this.hit=e.getComponent("base")}render(e,t){let i=r.instance.planet.scale;e.beginPath(),e.arc(t.x+this.hit.x*t.winScale,t.y+this.hit.y*t.winScale,this.hit.size/i*t.winScale,0,2*Math.PI),e.closePath(),e.fillStyle=this.app.backgroundColor,e.fill()}};var P=class l{constructor(){this.rocket=null}init(e){this.rocket=e.getComponent("base")}render(e,t){l.renderDummy(e,this.rocket.size*t.winScale,t.x+this.rocket.x*t.winScale,t.y+this.rocket.y*t.winScale,this.rocket.angle,this.rocket.flags)}static renderDummy(e,t,i,o,n,s){let a=(s&1)!=0,p=(s&2)!=0,u=(s&4)!=0,b=(s&8)!=0,H=(s&16)!=0,Me=(s&32)!=0;e.translate(i,o),e.rotate(n);let y=1;a&&(y*=1.25),Me&&(y*=1.5),e.beginPath(),e.lineTo(t*1.5*y,0),e.lineTo(t*.4*y,t*.75),H||(p?e.lineTo(-t*.4*y,0):(e.lineTo(-t*.75*y,t*.75),e.lineTo(-t*2.25*y,t*1.5*.75),u||e.lineTo(-t*2*y,0),e.lineTo(-t*2.25*y,-t*1.5*.75),e.lineTo(-t*.75*y,-t*.75))),e.lineTo(t*.4*y,-t*.75),e.closePath(),e.fillStyle=b?"#ddd":"#333",e.fill(),e.resetTransform()}};var M=class{constructor(e,t,i,o,n=.5){this.planet=e;this.x=t;this.y=i;this.size=o;this.explosionTime=n;this.entity=null;this.timer=0}init(e){e.zOrder=4,this.entity=e,r.instance.explosions.push(this)}update(e){if(this.timer+=e*this.planet.getTimeMultiplier(),this.timer>this.explosionTime){this.entity.destroy();let t=r.instance.explosions;t.splice(t.indexOf(this),1)}}alpha(){return Math.max(0,(1-this.timer/this.explosionTime)/Math.max(1,Math.log(1+this.size*10/g.SIZE/r.instance.planet.scale)))}};var A=class{constructor(){this.explosion=null}init(e){this.explosion=e.getComponent("base")}render(e,t){let i=r.instance.planet.scale;e.beginPath(),e.arc(t.x+this.explosion.x*t.winScale,t.y+this.explosion.y*t.winScale,this.explosion.size/i*t.winScale,0,2*Math.PI),e.closePath(),e.fillStyle="#fff",e.globalAlpha=this.explosion.alpha(),e.fill(),e.globalAlpha=1}};var Q=class{constructor(e,t,i){this.x=e;this.y=t;this.size=i;this.entity=null;this.collider=new C}init(e){this.entity=e,e.zOrder=2,r.instance.hits.push(this);let t=r.instance.planet;e.app.spawn({base:new M(t,this.x,this.y,this.size),ui:new A}),this.updateCollider(),t.tryDestroy(this.collider)}updateCollider(){this.collider.update({x:this.x,y:this.y,radius:this.size/r.instance.planet.scale})}};var D=Math.PI*2;function Re(l,e){var t=(e-l)%D;return 2*t%D-t}function Le(l,e,t){return l+Re(l,e)*t}function Ge(l,e){return Math.sqrt(l*l+e*e)}var R=class l{constructor(e,t,i,o,n,s){this.x=e;this.y=t;this.size=i;this.damage=o;this.speed=n;this.gravity=s;this.entity=null;this.app=null;this.collider=new C;this.penetration=1;this.trailTimer=0;this.trailSpawnAtTime=0;this.flags=0;let a=r.instance;this.angle=Math.atan2(this.y,this.x)-Math.PI+Math.random()*D/a.planet.scale/a.epoch.multipliers.reset,a.rockets.push(this)}init(e){this.entity=e,this.app=e.app,e.zOrder=5}update(e){let t=r.instance,i=t.planet,o=i.getTimeMultiplier();this.angle=Le(this.angle,Math.atan2(this.y,this.x)-Math.PI,Math.min(1,e*this.speed*o));let n=e*500*this.speed/i.scale*o;if(Ge(this.x,this.y)<n?(this.x=0,this.y=0,n=g.SIZE*i.scale):(this.x+=Math.cos(this.angle)*n,this.y+=Math.sin(this.angle)*n),this.updateCollider(),i.intersects(this.collider)&&this.collideWithPlanet(t,i,n),this.trailTimer+=e*o,this.trailTimer>this.trailSpawnAtTime){let a=Math.cos(this.angle),p=Math.sin(this.angle),u=this.size*2;this.app.spawn({base:new M(i,this.x-a*u,this.y-p*u,this.size*(6+Math.random())/10*i.scale,.33),ui:new A}),this.trailSpawnAtTime=Math.random()/30,this.trailTimer=0}}collideWithPlanet(e,t,i){let o=1e3,n=e.epoch.multipliers,s=Math.cos(this.angle),a=Math.sin(this.angle);do this.x-=s*i/2/t.scale,this.y-=a*i/2/t.scale,this.updateCollider();while(t.intersects(this.collider)&&o-- >0);for(;!t.intersects(this.collider)&&o-- >0;)this.x+=s*this.damage/10/t.scale,this.y+=a*this.damage/10/t.scale,this.updateCollider();(this.x>1e9||this.y>1e9)&&(this.x=0,this.y=0);let p=Math.sqrt(this.x*this.x+this.y*this.y)+1,u=1+(Math.pow(2,this.gravity)-1)/p;e.score+=this.damage*u/10*n.score,this.app.spawn({base:new Q(this.x,this.y,this.damage*u*n.power),ui:new $}),e.epoch.penetrationChance>Math.random()&&(this.penetration+=1),--this.penetration<=0&&(this.entity.destroy(),e.rockets.splice(e.rockets.indexOf(this),1))}updateCollider(){let e=r.instance.planet.scale;this.collider.update({x:this.x,y:this.y,radius:this.size/e})}spawnCloneOnOrbit(e){let t=l.spawnOnOrbit(this.damage,this.speed,this.gravity,e);return t.size=this.size,t.penetration=this.penetration,t.flags=this.flags,t}spawnClones(e,t){for(let i=e+1;--i;)this.spawnCloneOnOrbit(t)}static spawnOnOrbit(e,t,i,o){let n=r.instance,s=n.target.hidden||!o?Math.random()*D:n.target.angle+Math.random()*D/12-D/12/2,a=new l(Math.cos(s)*1200,Math.sin(s)*1200,8,e,t,i);return n.app.spawn({base:a,ui:new P}),a}};var Te=[{bg:"996",layers:["ff9","fd9","fe9","ff9","ef9","df9"]},{bg:"779",layers:["99f","9af","9cf","a9f","c9f"]},{bg:"a66",layers:["fa9","f2a291","fb9","e89","f9a","fa9","fc9"]},{bg:"5a7",layers:["8f9","80f690","7e8","6d7","7e7"]}],f=class f{constructor(){this.app=null;this.scale=1;this.destroyed=!1;this.deathTime=0;this.layers=[];this.rocketTime=1;this.rocketInterval=1;this.rocketPower=100;this.rocketSpeed=1;this.rocketGravity=0;this.shootRockets=!1;this.collider=new C;this.centerCollider=new C}init(e){e.zOrder=1,this.app=e.app,this.updateColliders(),this.updatePalette(),this.spawnDecorations()}update(e){let t=r.instance,i=this.getTimeMultiplier();if(this.rotate(e/10*i),this.shootRockets){this.rocketTime+=e*i;let n=this.getRocketInterval();this.rocketTime>n&&(R.spawnOnOrbit(this.rocketPower,this.rocketSpeed*t.epoch.multipliers.speed,this.rocketGravity,!0),this.rocketTime=0)}if(!this.destroyed)return;let o=t.getTimeSpeed();this.deathTime+=e*o,this.app.shakePower=10*i/o,this.deathTime>f.DEATH_TIME*t.epoch.multipliers.reset&&this.respawn()}respawn(e=!0,t=!0){let i=r.instance;if(this.scale*=Math.pow(1.125,2/Math.sqrt(this.scale)),t&&(i.score+=Math.pow(50*i.level,1.1)*i.epoch.multipliers.score),i.level+=Math.round(i.epoch.multipliers.level),!!e)switch(i.clearAll(),this.updateColliders(),this.destroyed=!1,this.deathTime=0,this.app.shakePower=0,this.updatePalette(),this.spawnDecorations(),this.rocketTime=this.rocketInterval,t&&i.score>1e6&&c.unlock("One Million"),i.level){case 10:c.unlock("Level 10");break;case 1e3:c.unlock("Level 1000");break;case 1e4:c.unlock("The End");break;case 3:c.unlock("Rocket 2");break;case 7:c.unlock("Rocket 3");break;case 15:c.unlock("Rocket 4");break;case 25:c.unlock("Rocket 5");break;case 40:c.unlock("Rocket 6");break;case 60:c.unlock("Rocket 7");break;case 80:c.unlock("Rocket 8");break}}updatePalette(){let e=Te[Math.floor(Math.random()*Te.length)];this.makeLayers(e.layers),this.app.backgroundColor="#"+e.bg}spawnDecorations(){if(this.scale>50)return;let e=Math.min(80,Math.round(30*this.scale));for(let t=0;t<e;++t){let i=Math.PI*2*t/e+(Math.random()*30-15)*Math.PI/180;this.app.spawn({base:new j(Math.cos(i)*f.SIZE,Math.sin(i)*f.SIZE,10*Math.sqrt(this.scale)+Math.random()*40,i,Math.random()>.36?0:1),ui:new q})}}makeLayers(e){this.layers.splice(0,this.layers.length);let t=f.SIZE*this.scale,i=this.centerAreaRadius(),o=0;for(;t>i;)this.layers.push({radius:t/this.scale,color:"#"+e[o%e.length]}),o==0?t-=15*this.scale:t-=5*this.scale+50*o+40*o*Math.random()+5*this.scale*Math.random(),o+=1}updateColliders(){this.collider.update({x:0,y:0,radius:f.SIZE}),this.centerCollider.update({x:0,y:0,radius:this.centerAreaRadius()})}intersects(e){if(!this.collider.intersects(e,!0))return!1;for(let t of r.instance.hits)if(t.collider.intersects(e,!0))return!1;return!0}tryDestroy(e){this.centerCollider.intersects(e,!1)&&(this.destroyed=!0)}centerAreaRadius(){return f.SIZE*Math.max(.05,.25-this.scale/10*.2)}getTimeMultiplier(){let e=r.instance,t=e.getTimeSpeed();if(this.deathTime==0)return t;let i=e.epoch.multipliers.reset;return Math.max(0,f.DEATH_TIME-this.deathTime/i)/1.5/f.DEATH_TIME*t}rotate(e){let t=Math.sin(e);for(let i of r.instance.hits)i.x=i.x-i.y*t,i.y=i.x*t+i.y,i.updateCollider();for(let i of r.instance.explosions)i.x=i.x-i.y*t,i.y=i.x*t+i.y;for(let i of r.instance.decorations)i.x=i.x-i.y*t,i.y=i.x*t+i.y,i.angle+=e}reset(){this.rocketPower=100,this.rocketSpeed=1,this.rocketGravity=0,this.scale=1,this.destroyed=!1,this.deathTime=0,this.rocketTime=1,this.rocketInterval=1,this.app.shakePower=0,this.updateColliders(),this.updatePalette(),this.spawnDecorations()}getRocketInterval(){return this.rocketInterval*r.instance.epoch.multipliers.interval}postLoad(e){for(let t=0;t<e-1;++t)this.respawn(!1,!1);this.respawn(!0,!1)}};f.SIZE=250,f.SIZE_SQUARE=f.SIZE*f.SIZE,f.DEATH_TIME=.75;var g=f;var J=class extends d{constructor(){super("Faster Reset","x0.8",1)}onPurchase(e){e.epoch.multipliers.reset*=.8,e.epoch.multipliers.speed*=1.1,this.cost*=2}getDescription(){return"Decrease planet's reset by 20% each upgrade. Current reset time is "+(g.DEATH_TIME*r.instance.epoch.multipliers.reset*1e3).toFixed(0)+"ms. Also buffs rockets speed by x1.1"}};var K=class extends d{constructor(){super("Power","+1",1)}onPurchase(e){e.epoch.multipliers.power+=1,this.cost*=2}getDescription(){return"Increase the power multiplier by 1. Current power multiplier is "+r.instance.epoch.multipliers.power}};var _=class extends d{constructor(){super("Score","+1",1)}onPurchase(e){e.epoch.multipliers.score+=1,this.cost*=2}getDescription(){return"Increase score (income) multiplier by 1. Current score multiplier is "+r.instance.epoch.multipliers.score}};var ee=class extends d{constructor(){super("Time","+0.1",1)}onPurchase(e){e.epoch.multipliers.time+=.1,this.cost*=2}getDescription(){return"Speed up the time. Current time multiplier is "+r.instance.epoch.multipliers.time.toFixed(1)}};var te=class extends h{constructor(){super("UPGRADES",{offsetX:-170,offsetY:40,screenX:1,width:300,height:40,fontSize:26,fontColor:"#fff",strokeWidth:4,strokeColor:"rgb(218, 255, 55)",overStrokeColor:"rgb(191, 221, 61)",pressStrokeColor:"rgb(228, 255, 106)",rounding:20})}onClick(){r.instance.overlay.scene=2}};var ie=class extends h{constructor(){super("NEW EPOCH",{offsetY:108,screenX:.5,screenY:0,width:300,height:24,fontSize:20,fontColor:"#fff",strokeWidth:4,strokeColor:"rgb(218, 255, 55)",overStrokeColor:"rgb(191, 221, 61)",pressStrokeColor:"rgb(228, 255, 106)",rounding:12})}onClick(){r.instance.epoch.endEpoch()}};var oe=class extends h{constructor(){super("PLAY",{offsetY:100,screenX:.5,screenY:.5,width:300,height:40,fontSize:26,fontColor:"#fff",strokeWidth:4,strokeColor:"hsl(199, 64%, 71%)",overStrokeColor:"hsl(200, 100%, 86%)",pressStrokeColor:"hsl(199, 53%, 76%)",rounding:20})}onClick(){let e=r.instance;e.planet.shootRockets=!0,e.overlay.scene=1,e.target.canClick=!0}};var v=class extends h{constructor(t,i=1,o=!1){super("",{screenX:.5,screenY:1,width:80,height:80});this.config=t;this.reloadTime=i;this.unlocked=o;this.rotation=0;this.reload=0}render(t,i){if(this.hidden)return;let o=this.measure(i),n=Math.cos(this.rotation),s=Math.sin(this.rotation);if(super.update(i.width,i.height,i.winScale,o.width/2),t.beginPath(),t.arc(o.x+o.w/2,o.y+o.h/2,o.w/2,0,2*Math.PI),t.closePath(),t.fillStyle="rgba(255,255,255,0.5)",t.fill(),t.beginPath(),t.moveTo(o.x+o.w/2,o.y+o.h/2),t.arc(o.x+o.w/2,o.y+o.h/2,o.w/2,0,2*Math.PI*this.reload/this.reloadTime),t.closePath(),t.fillStyle="#fff",t.fill(),!this.unlocked){t.font=52*i.winScale+"px Ubuntu",t.textAlign="center",t.textBaseline="middle",t.fillStyle="#333",t.fillText("?",o.x+o.w/2,o.y+o.h/2);return}let a=1.5;P.renderDummy(t,this.config.dummySize*i.winScale*a,o.x+o.w/2+this.config.offset*i.winScale*n*a,o.y+o.h/2+this.config.offset*i.winScale*s*a,this.rotation,this.config.flags),this.rotation+=i.dt,this.reload=Math.min(this.reloadTime,this.reload+i.dt)}onClick(){if(this.reload!=this.reloadTime)return;let t=r.instance,i=t.planet,o=R.spawnOnOrbit(i.rocketPower*this.config.damage,i.rocketSpeed*(this.config.speed||1)*t.epoch.multipliers.speed,i.rocketGravity*(this.config.gravity||1),!0);o.size=this.config.size,o.flags=this.config.flags,this.config.onSpawn?.(o),this.reload=0}};var Ee=[[new v({offset:5,dummySize:10,size:12.5,damage:1.25,flags:0},1,!0),new v({offset:5,dummySize:9,size:12.5,speed:2,damage:.6,gravity:.5,onSpawn:l=>l.penetration=4,flags:1},4),new v({offset:5,dummySize:11.5,size:20,speed:.6,damage:3,flags:4},8),new v({offset:-3,dummySize:8,size:8,speed:1.5,damage:.5,flags:2},.125),new v({offset:6,dummySize:13,size:60,speed:.2,damage:90,gravity:.1,flags:8},90)],[new v({offset:5,dummySize:8,size:15,speed:3,damage:.4,gravity:0,onSpawn:l=>l.penetration=8,flags:32},12),new v({offset:-4,dummySize:7,size:7,speed:2,damage:.5,onSpawn:l=>l.spawnClones(24,!1),flags:16},5),new v({offset:5,dummySize:7,size:10,speed:4,damage:.3,gravity:0,onSpawn:l=>l.penetration=16,flags:33},15)]];var re=class extends h{constructor(){super("START",{offsetY:-60,screenX:.5,screenY:1,width:300,height:40,fontSize:26,fontColor:"#fff",strokeWidth:4,strokeColor:"rgb(218, 255, 55)",overStrokeColor:"rgb(191, 221, 61)",pressStrokeColor:"rgb(228, 255, 106)",rounding:12})}onClick(){let e=r.instance;e.planet.shootRockets=!0,e.overlay.scene=1,e.target.canClick=!0}};var S=class extends h{constructor(t,i,o){super("BUY",{screenY:1,width:120,height:42,fontSize:28,fontColor:"#fff",strokeWidth:4,strokeColor:"hsl(199, 64%, 71%)",overStrokeColor:"hsl(200, 100%, 86%)",pressStrokeColor:"hsl(199, 53%, 76%)",rounding:20});this.name=t;this.cost=i;this.maxLevel=o;this.cachedDescription=[];this.level=0;this.initialCost=i}render(t,i){this.cachedDescription.length==0&&(this.cachedDescription=this.getDescription());let o=this.measure(i),n=180*i.winScale,s=this.getDescription(),a=20*s.length*i.winScale,p=60*i.winScale,u=90*i.winScale;t.beginPath(),t.roundRect(o.x-n/2,o.y-u-a,o.w+n,o.h+u+a*2,[16,16,0,0]),t.closePath(),t.fillStyle=this.cost<r.instance.score?"rgba(0,0,0,0.4)":"rgba(0,0,0,0.6)",t.fill(),t.font=36*i.winScale+"px Ubuntu",t.textAlign="center",t.textBaseline="middle",t.fillStyle="#eee",t.fillText(this.name+" ["+this.level+"]",o.x+p,o.y-a-60*i.winScale),t.font=18*i.winScale+"px Ubuntu",t.fillStyle="#ddd",t.fillText(this.level==this.maxLevel?"MAX":"Cost: "+r.format(this.cost),o.x+p,o.y-a-28*i.winScale),t.fillStyle="#ddd",t.font=12*i.winScale+"px Ubuntu";for(let b=s.length-1;b>=0;--b)t.fillText(s[b],o.x+p,o.y-25*i.winScale-20*b*i.winScale);super.render(t,i)}onClick(){let t=r.instance;t.score<this.cost||this.level>=this.maxLevel||(t.score-=this.cost,this.onPurchase(t),this.level+=1,this.cachedDescription=this.getDescription(),this.level==this.maxLevel&&(this.text="MAX"))}reset(){this.level=1,this.cost=this.initialCost,this.cachedDescription=this.getDescription(),this.text="BUY"}purchaseMany(t,i){for(let o=0;o<i;++o)this.onPurchase(t)}onSave(t){t.writeU8(this.level)}onLoad(t){this.level=t.readU8()}};var ne=class extends S{constructor(){super("Gravity",100,50)}onPurchase(e){e.planet.rocketGravity+=.2,this.cost+=this.cost/3*e.epoch.multipliers.cost}getDescription(){return["+0.2 rocket gravity per upgrade","to the planet. Grows geometrically!","Rockets will damage more if they are closer","Current rocket gravity: "+r.instance.planet.rocketGravity.toFixed(1)]}};var le=class extends S{constructor(){super("Less Interval",100,60)}onPurchase(e){e.planet.rocketInterval*=.95,this.cost+=this.cost/3.5*e.epoch.multipliers.cost}getDescription(){return["Decreases the rocket interval by x0.95","Current rocket interval: "+(r.instance.planet.rocketInterval*1e3).toFixed(1)+"ms"]}};var se=class extends S{constructor(){super("Power",100,100)}onPurchase(e){e.planet.rocketPower*=1.1,this.cost+=this.cost/6*e.epoch.multipliers.cost}getDescription(){return["x1.1 rocket power","Current rocket power: "+r.format(r.instance.planet.rocketPower)]}};var ae=class extends S{constructor(){super("Speed",100,100)}onPurchase(e){this.level%10==9&&(this.cost+=this.cost*e.epoch.multipliers.cost),e.planet.rocketSpeed=Math.pow(e.planet.rocketSpeed*1.45,1.01),this.cost+=this.cost/1.1*e.epoch.multipliers.cost}getDescription(){return["x1.45 rocket speed (^1.01)","Current rocket speed: "+r.format(r.instance.planet.rocketSpeed,1)]}};var Se=class Se{constructor(){this.achievementsStack=[];this.achievementTimer=0;this.nextAchievementAt=0;this.entity=null;this.scene=0;this.upgrades=[new se,new le,new ae,new ne];this.epochUpgrades=[new K,new _,new W,new ee,new Z,new J];this.challengeButtons=null;this.rocketButtons=Ee;this.rocketButtonsEnabled=!0;this.play=new oe;this.newEpoch=new ie;this.startEpoch=new re;this.challenges=new V;this.epoch=new te;this.endChallenge=new F;this.logoImage=new Image,this.logoImage.src="logo.png"}init(e){e.zOrder=6,this.challengeButtons=r.instance.epoch.challenges.map(t=>new X(t)),this.entity=e}update(e){this.nextAchievementAt&&(this.achievementTimer+=e,this.achievementTimer>this.nextAchievementAt&&(this.achievementsStack.shift(),this.achievementTimer=0,this.achievementsStack[0]||(this.nextAchievementAt=0)))}pushAchievement(e){this.achievementsStack.push(e),this.nextAchievementAt=Se.ACHIEVEMENT_TIME,this.achievementTimer=0}getAchievement(){return this.achievementsStack[0]}achievementAlpha(){return this.nextAchievementAt?Math.min(1,this.achievementTimer/.1/this.nextAchievementAt)-Math.max(0,(this.achievementTimer-this.nextAchievementAt*.9)/.1/this.nextAchievementAt):0}resetUpgrades(){for(let e of this.upgrades)e.reset()}unlockRocket(e,t){let i=this.rocketButtons[e];if(!i)return;let o=i[t];o&&(o.unlocked=!0)}onSave(e){e.writeU8(this.scene),e.writeArray(this.upgrades),e.writeArray(this.epochUpgrades)}onLoad(e){this.scene=e.readU8(),e.loadArray(this.upgrades),e.loadArray(this.epochUpgrades)}postLoad(){for(let e of this.upgrades)e.purchaseMany(r.instance,e.level);for(let e of this.epochUpgrades)e.purchaseMany(r.instance,e.level)}};Se.ACHIEVEMENT_TIME=5;var ce=Se;var k=class{constructor(e,t,i){this.name=e;this.description=t;this.reward=i;this.startTime=null;this.completedTime=null;this.completed=!1}start(){let e=r.instance;e.epoch.currentChallenge=this,this.startTime=x.now(),e.planet.shootRockets=!0,e.target.canClick=!0,this.onStart(e),e.overlay.scene=1}end(e){if(!this.startTime)return;let t=r.instance;if(this.onEnd(t),t.epoch.currentChallenge=null,!e){this.startTime=null;return}this.completedTime=x.now()-this.startTime,this.completed||this.onReward(t),this.completed=!0}isInChallenge(){return this.startTime!=null}onSave(e){e.writeU8((this.name.length+this.description.length+this.reward.length)%255),e.writeBoolean(this.completed),this.completed&&e.writeF64(this.completedTime),e.writeBoolean(this.isInChallenge()),this.isInChallenge()&&e.writeF64(this.startTime)}onLoad(e){if((this.name.length+this.description.length+this.reward.length)%255!=e.readU8()){e.readBoolean()&&e.readF64(),e.readBoolean()&&e.readF64();return}this.completed=e.readBoolean(),this.completed&&(this.completedTime=e.readF64()),e.readBoolean()&&(this.startTime=e.readF64(),this.onStart(r.instance))}};var pe=class extends k{constructor(){super("Active","Auto rockets are disabled","2x rocket reload")}onStart(e){e.planet.shootRockets=!1}onReward(e){e.epoch.multipliers.interval/=2}onEnd(e){e.planet.shootRockets=!0}};var he=class extends k{constructor(){super("Epoch","Epoch gain x0.1 (starts from level 500) and rockets are 10x slower","+2 level per level")}onStart(e){e.epoch.multipliers.epoch*=.1,e.epoch.multipliers.speed/=10}onReward(e){e.epoch.multipliers.level+=1}onEnd(e){e.epoch.multipliers.epoch/=.1,e.epoch.multipliers.speed*=10}};var me=class extends k{constructor(){super("Offline","Target and buttons are disabled","2x button reload")}onStart(e){e.target.canClick=!1,e.overlay.rocketButtonsEnabled=!1}onReward(e){for(let t of e.overlay.rocketButtons)for(let i of t)i.reloadTime/=2}onEnd(e){e.target.canClick=!0,e.overlay.rocketButtonsEnabled=!0}};var ue=class ue{constructor(){this.challenges=[new me,new pe,new he];this.currentChallenge=null;this.multipliers={power:1,cost:1,score:1,time:1,reset:1,speed:1,epoch:1,level:1,interval:1};this.penetrationChance=0;this.points=0;this.count=0}endEpoch(){let e=r.instance;this.count==0&&c.unlock("First Epoch"),this.count+=1,this.points+=this.calculatePoints(e.level),e.reset(),e.overlay.scene=2,e.planet.shootRockets=!1,e.target.canClick=!1,this.points>1e6&&c.unlock("Evolution"),this.currentChallenge?.end(!0)}calculatePoints(e){return Math.round(Math.pow(e/ue.EPOCH_LEVEL,2+e/1e3)*this.multipliers.epoch)}isInChallenge(){return this.currentChallenge!=null}calculateProgress(e){return Math.min(1,e/ue.EPOCH_LEVEL*this.multipliers.epoch)}onSave(e){e.writeU32(this.count),e.writeF64(this.points),e.writeArray(this.challenges),e.writeU8(this.currentChallenge?this.challenges.indexOf(this.currentChallenge)+1:0)}onLoad(e){this.count=e.readU32(),this.points=e.readF64(),e.loadArray(this.challenges);let t=e.readU8()-1;t>-1&&(this.currentChallenge=this.challenges[t])}};ue.EPOCH_LEVEL=100;var de=ue;var m=class m{constructor(e=new Uint8Array(m.INITIAL_SIZE),t=m.INITIAL_SIZE){this.u8=e;this.length=t;this.offset=0;this.dataview=new DataView(this.u8.buffer)}static fromU8(e){return new m(e,e.length)}static fromLocalStorage(){let e=localStorage.getItem("save");if(e)return m.fromU8(new Uint8Array(atob(e).split("").map(t=>t.charCodeAt(0))))}toLocalStorage(){localStorage.setItem("save",btoa(Array.from(this.u8.slice(0,this.offset)).map(e=>String.fromCharCode(e)).join("")))}grow(){let e=new Uint8Array(this.length+=m.INITIAL_SIZE);e.set(this.u8,0),this.u8=e,this.dataview=new DataView(this.u8.buffer)}shouldGrow(e){this.offset+e>this.length&&this.grow()}writeU8(e){this.shouldGrow(1),this.u8[this.offset]=e,this.offset+=1}writeU16(e){this.shouldGrow(2),this.dataview.setUint16(this.offset,e,m.LITTLE_ENDIAN),this.offset+=2}writeU32(e){this.shouldGrow(4),this.dataview.setUint32(this.offset,e,m.LITTLE_ENDIAN),this.offset+=4}writeF64(e){this.shouldGrow(8),this.dataview.setFloat64(this.offset,e,m.LITTLE_ENDIAN),this.offset+=8}writeBoolean(e){this.writeU8(e?1:0)}writeString(e){this.shouldGrow(e.length+1);for(let t=0;t<e.length;t++)this.u8[this.offset]=e.charCodeAt(t),this.offset+=1;this.u8[this.offset]=0,this.offset+=1}write(e){e.onSave(this)}writeArray(e){this.writeU8(e.length);for(let t=0;t<e.length;t++)this.write(e[t])}isCorrupted(){return this.offset>this.length}checkCorruption(){if(this.isCorrupted())throw new Error("Save is corrupted")}readU8(){let e=this.u8[this.offset];return this.offset+=1,this.checkCorruption(),e}readU16(){let e=this.dataview.getUint16(this.offset,m.LITTLE_ENDIAN);return this.offset+=2,this.checkCorruption(),e}readU32(){let e=this.dataview.getUint32(this.offset,m.LITTLE_ENDIAN);return this.offset+=4,this.checkCorruption(),e}readF64(){let e=this.dataview.getFloat64(this.offset,m.LITTLE_ENDIAN);return this.offset+=8,this.checkCorruption(),e}readBoolean(){return this.readU8()==1}readString(){let e="";for(;this.u8[this.offset]!=0;)e+=String.fromCharCode(this.readU8());return this.offset+=1,this.checkCorruption(),e}load(e){e.onLoad(this)}loadArray(e){let t=this.readU8();for(let i=0;i<t;++i)this.load(e[i])}};m.VERSION=1,m.INITIAL_SIZE=65535,m.LITTLE_ENDIAN=!0;var T=m;var w=class w{constructor(e,t,i,o){this.app=e;this.overlay=t;this.planet=i;this.target=o;this.Achievement=c;this.rockets=[];this.hits=[];this.explosions=[];this.decorations=[];this.epoch=new de;this.score=0;w.instance=this,this.level=Math.round(this.epoch.multipliers.level),w.isMobile?(window.addEventListener("touchstart",this.onTouchStart.bind(this)),window.addEventListener("touchend",this.onTouchEnd.bind(this)),window.addEventListener("touchcancel",this.onTouchEnd.bind(this)),window.addEventListener("touchmove",this.onTouchMove.bind(this))):(window.addEventListener("mousedown",this.onMouseStart.bind(this)),window.addEventListener("mouseup",this.onMouseEnd.bind(this)),window.addEventListener("mousemove",this.onMouseMove.bind(this))),window.addEventListener("beforeunload",()=>{let n=new T;n.write(this),n.toLocalStorage()})}onSave(e){e.writeU8(T.VERSION),e.writeU32(this.level),e.writeF64(this.score),e.write(this.overlay),e.write(this.epoch),e.writeArray(c.all)}onLoad(e){if(e.readU8()!=T.VERSION&&prompt("This save is from an older version of the game. Do you want to delete it (yes/no)?")!="yes")return;let t=e.readU32();this.score=e.readF64(),e.load(this.overlay),e.load(this.epoch),this.planet.postLoad(t),this.level-=1,this.overlay.postLoad(),e.loadArray(c.all)}setMousePosition(e,t){w.mouse.x=e*window.devicePixelRatio,w.mouse.y=t*window.devicePixelRatio}onMouseStart(e){e.button==0&&(w.mouse.click=!0),this.onMouseMove(e)}onMouseMove(e){this.setMousePosition(e.clientX,e.clientY)}onMouseEnd(e){e.button==0&&(w.mouse.click=!1),this.onMouseMove(e)}onTouchStart(e){w.mouse.click=!0,this.onTouchMove(e)}onTouchMove(e){let t=e.touches[0];this.setMousePosition(t.clientX,t.clientY)}onTouchEnd(e){w.mouse.click=!1}clearRockets(){for(let e of this.rockets)e.entity.destroy();this.rockets.splice(0,this.rockets.length)}clearHits(){for(let e of this.hits)e.entity.destroy();this.hits.splice(0,this.hits.length)}clearExplosions(){for(let e of this.explosions)e.entity.destroy();this.explosions.splice(0,this.explosions.length)}clearTrees(){for(let e of this.decorations)e.entity.destroy();this.decorations.splice(0,this.decorations.length)}clearAll(){this.clearRockets(),this.clearHits(),this.clearExplosions(),this.clearTrees()}getTimeSpeed(){return this.epoch.multipliers.time}reset(){this.score=0,this.level=Math.round(this.epoch.multipliers.level),this.clearAll(),this.planet.reset(),this.overlay.resetUpgrades()}static format(e,t=0){return e>1e6?e.toExponential(2):e.toFixed(t)}};w.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),w.mouse={x:0,y:0,click:!1},w.instance=null;var r=w;var E=class E{constructor(e,t,i,o){this.name=e;this.description=t;this.reward=i;this.onUnlock=o;this.id=E.ID++;this.isUnlocked=!1;E.all.push(this)}unlock(e=!0){this.isUnlocked||(e&&r.instance.overlay.pushAchievement(this),this.onUnlock&&this.onUnlock(r.instance),this.isUnlocked=!0)}static unlock(e,t=!0){for(let i=0,o=E.all.length;i<o;++i)if(E.all[i].name==e){E.all[i].unlock(t);break}}onSave(e){e.writeU8(this.id),e.writeBoolean(this.isUnlocked)}onLoad(e){if(this.id!=e.readU8()){e.readBoolean();return}this.isUnlocked=e.readBoolean(),this.isUnlocked&&this.onUnlock&&this.onUnlock(r.instance)}};E.ID=0,E.all=[];var c=E;var fe=class fe{constructor(){this.x=0;this.y=0;this.angle=0;this.hidden=!0;this.canClick=!1;this.holding=!1;this.lastClickTimer=0}init(e){}update(e){if(!this.canClick)return;let t=r.instance,i=t.app.window.canvas,o=r.mouse,n=o.x-i.cachedWidth/2,s=o.y-i.cachedHeight/2;if(n*n+s*s<g.SIZE_SQUARE*i.windowScale*i.windowScale&&(t.app.setCursorStyle("pointer"),o.click&&!this.holding?(this.x=o.x,this.y=o.y,this.angle=Math.atan2(s,n),this.hidden=!1,this.lastClickTimer=0,this.holding=!0):o.click||(this.holding=!1)),this.hidden)return;let a=t.planet;this.lastClickTimer+=e*a.getTimeMultiplier(),this.lastClickTimer>fe.ACTIVE_TIME&&(this.lastClickTimer=0,this.hidden=!0)}alpha(){return Math.max(0,1-this.lastClickTimer/fe.ACTIVE_TIME)}};fe.ACTIVE_TIME=2;var be=fe;var ge=class{constructor(){this.overlay=null}init(e){this.overlay=e.getComponent("base")}render(e,t){switch(this.overlay.scene){case 0:this.renderMenu(e,t);break;case 1:this.renderGame(e,t);break;case 2:this.renderEpoch(e,t);break;case 3:this.renderChallenges(e,t);break}this.renderAchievement(e,t)}renderMenu(e,t){e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,t.width,t.height);let i=this.overlay.logoImage,o=400*t.winScale;i.complete&&e.drawImage(i,t.x-o/2,t.y-o/2-150*t.winScale,o,o),this.overlay.play.render(e,t)}renderGame(e,t){let i=r.instance;e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,t.width,40*t.winScale),e.fillStyle="#fff",e.font=26*t.winScale+"px Ubuntu",e.textAlign="left",e.textBaseline="middle",e.fillText("PLANET DESTROYER",7*t.winScale,20*t.winScale),e.textAlign="center",e.fillText(r.format(i.score)+" score",t.width/2,20*t.winScale),e.font=36*t.winScale+"px Ubuntu",e.fillText("Level "+i.level,t.width/2,72*t.winScale);let o=this.overlay.upgrades;o[0].options.offsetX=180,o[0].options.offsetY=-40,o[0].render(e,t),o[1].options.offsetX=520,o[1].options.offsetY=-40,o[1].render(e,t),o[2].options.screenX=1,o[2].options.offsetX=-520,o[2].options.offsetY=-40,o[2].render(e,t),o[3].options.screenX=1,o[3].options.offsetX=-180,o[3].options.offsetY=-40,o[3].render(e,t),this.renderEpochGain(e,t,i.epoch.calculateProgress(i.level),i),this.renderRocketButtons(e,t),i.epoch.isInChallenge()&&this.overlay.endChallenge.render(e,t)}renderRocketButtons(e,t){if(!this.overlay.rocketButtonsEnabled)return;let i=this.overlay.rocketButtons,o=84,n=84,s=i.length;for(let a=0;a<s;++a){let p=i[a].length,u=o*p;for(let b=0;b<p;++b){let H=i[a][b];H.options.offsetX=(b+.5)*o-u/2,H.options.offsetY=-(a+.75)*n,H.render(e,t)}}}renderEpochGain(e,t,i,o){if(!(i<.5)){if(i<1){let n=300*t.winScale;e.beginPath(),e.roundRect(t.width/2-n/2,94*t.winScale,n,24*t.winScale,12*t.winScale),e.closePath(),e.fillStyle="rgba(0,0,0,0.25)",e.fill(),e.beginPath(),e.roundRect(t.width/2-n/2,94*t.winScale,n*i,24*t.winScale,12*t.winScale),e.closePath(),e.fillStyle="rgb(218,255,55)",e.fill();return}this.overlay.newEpoch.text=r.format(o.epoch.calculatePoints(o.level))+" EP GAIN",this.overlay.newEpoch.render(e,t)}}renderEpoch(e,t){let i=r.instance;e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,t.width,t.height),e.font=36*t.winScale+"px Ubuntu",e.textAlign="center",e.textBaseline="middle",e.fillStyle="rgb(218,255,55)",e.fillText(r.format(i.epoch.points)+" Epoch Points",t.width/2,36*t.winScale),e.font=24*t.winScale+"px Ubuntu",e.fillStyle="rgb(127, 148, 33)",e.fillText(i.epoch.count+" Epoch",t.width/2,64*t.winScale);for(let o=0,n=this.overlay.epochUpgrades.length;o<n;++o){let s=this.overlay.epochUpgrades[o];s.options.offsetY=130*(o+1),s.render(e,t)}this.overlay.startEpoch.render(e,t),this.overlay.challenges.render(e,t)}renderChallenges(e,t){e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,t.width,t.height),e.font=36*t.winScale+"px Ubuntu",e.textAlign="center",e.textBaseline="middle",e.fillStyle="rgb(255, 55, 55)",e.fillText("Challenges",t.width/2,36*t.winScale),e.font=24*t.winScale+"px Ubuntu",e.fillStyle="rgb(194, 43, 43)",e.fillText("To complete the challenge you need to start new epoch",t.width/2,64*t.winScale);for(let i=0,o=this.overlay.challengeButtons.length;i<o;++i){let n=this.overlay.challengeButtons[i];n.options.offsetY=130*(i+1),n.render(e,t)}this.overlay.epoch.render(e,t)}renderAchievement(e,t){let i=this.overlay.getAchievement();if(!i)return;let o=t.winScale,n=500*o,s=108*o-(i.reward?0:21*o),a=20*o,p=20*o;e.globalAlpha=this.overlay.achievementAlpha(),e.beginPath(),e.roundRect(a,p,n,s,16),e.closePath(),e.fillStyle="rgba(0,0,0,0.5)",e.fill(),e.font=24*o+"px Ubuntu",e.textAlign="left",e.textBaseline="top",e.fillStyle="#fff",e.fillText(i.name,a+16*o,p+16*o),e.fillStyle="#ccc",e.font=16*o+"px Ubuntu",e.fillText(i.description[0],a+16*o,p+42*o),e.fillText(i.description[1],a+16*o,p+60*o),i.reward&&(e.fillStyle="#fff",e.fillText("Reward: "+i.reward,a+16*o,p+81*o)),e.globalAlpha=1}};var we=class{constructor(){this.planet=null}init(e){this.planet=e.getComponent("base")}render(e,t){for(let i=0,o=this.planet.layers.length;i<o;++i){let n=this.planet.layers[i];e.beginPath(),e.arc(t.x,t.y,n.radius*t.winScale,0,2*Math.PI),e.closePath(),e.fillStyle=n.color,e.fill()}e.beginPath(),e.arc(t.x,t.y,this.planet.centerAreaRadius()*t.winScale,0,2*Math.PI),e.closePath(),e.fillStyle="#e66",e.fill()}};var Ce=class Ce{constructor(){this.target=null}init(e){this.target=e.getComponent("base")}render(e,t){if(this.target.hidden)return;let i=150*t.winScale;e.translate(this.target.x,this.target.y),e.scale(i,i),e.globalAlpha=this.target.alpha(),e.fillStyle="#fff",e.fill(Ce.PATH),e.globalAlpha=1,e.resetTransform()}};Ce.PATH=new Path2D("M.2952-.0401V-.2993H.036v.1074H-.0401V-.2993H-.2993v.2592h.1074V.036H-.2993V.2952h.2592V.1878H.036V.2952H.2952V.036H.1878V-.0401H.2952Zm.0713 0H.4958V.036H.3665V.3665H.036V.4958H-.0401V.3665H-.3707V.036H-.5V-.0401h.1293V-.3707h.3306V-.5H.036v.1293H.3665v.3305Z");var ve=Ce;new c("Level 10",["Reach level 10","Easy start"],"+10% rockets speed",l=>l.epoch.multipliers.speed*=1.1);new c("One Million",["Reach 1.000.000 score",""],"+10% score",l=>l.epoch.multipliers.score+=.1);new c("First Epoch",["Get your first epoch","Prestige at level 100+"],"4x reset speed",l=>l.epoch.multipliers.reset/=4);new c("Level 1000",["Reach level 1000",""],"+50% rockets power",l=>l.epoch.multipliers.power+=.5);new c("Evolution",["Reach 1.000.000 EP",""],"2x EP gain",l=>l.epoch.multipliers.epoch*=2);new c("The End",["Reach level 10000","At the end of the game"],"`dev` variable unlocked in console",l=>window.dev=l);new c("Rocket 2",["Reach level 3",""],"Unlock new rocket",l=>l.overlay.unlockRocket(0,1));new c("Rocket 3",["Reach level 7",""],"Unlock new rocket",l=>l.overlay.unlockRocket(0,2));new c("Rocket 4",["Reach level 15",""],"Unlock new rocket",l=>l.overlay.unlockRocket(0,3));new c("Rocket 5",["Reach level 25",""],"Unlock new rocket",l=>l.overlay.unlockRocket(0,4));new c("Rocket 6",["Reach level 40",""],"Unlock new rocket",l=>l.overlay.unlockRocket(1,0));new c("Rocket 7",["Reach level 60",""],"Unlock new rocket",l=>l.overlay.unlockRocket(1,1));new c("Rocket 8",["Reach level 80",""],"Unlock new rocket",l=>l.overlay.unlockRocket(1,2));var ye=new x,Ie=new ce,Ue=new g,Pe=new be,De=new r(ye,Ie,Ue,Pe);ye.spawn({base:Ie,ui:new ge});ye.spawn({base:Ue,ui:new we});ye.spawn({base:Pe,ui:new ve});var xe=T.fromLocalStorage();if(xe)try{xe.load(De)}catch(l){l.message.includes("Invalid")?alert(l.message):console.error(l)}ye.run();})();
